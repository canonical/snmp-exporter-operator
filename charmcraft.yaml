# Copyright 2023 Canonical Ltd.
# See LICENSE file for licensing details.
name: snmp-exporter
type: charm
summary: Prometheus compatible SNMP exporter.
description: |
  Exporter that exposes information gathered from SNMP for use by the a Prometheus compatible monitoring system.

links:
  documentation: https://discourse.charmhub.io/t/snmp-exporter-docs-index/12050
  website: https://charmhub.io/snmp-exporter
  source: https://github.com/canonical/snmp-exporter-operator
  issues: https://github.com/canonical/snmp-exporter-operator/issues


platforms:
  ubuntu@22.04:amd64:
  ubuntu@24.04:amd64:

parts:
  charm:
    source: .
    plugin: uv
    build-packages: [git]
    build-snaps: [astral-uv]
    override-build: |
      craftctl default
      git describe --always > $CRAFT_PART_INSTALL/version

provides:
  cos-agent:
    interface: cos_agent
    optional: true
    limit: 1

config:
  options:
    targets:
      default: ""
      type: string
      description: |
          Comma separated list of targets to scrape
    config_file:
      type: string
      default: ""
      description: >
        Custom SNMP configuration file (yaml).
        To send the contents of a file to this configuration option, the symbol `@` must be used.

        Usage: juju config snmp-exporter config_file=@snmp.yaml

        The content of this file should not be manually created or edited by user. 
        For reference on how to generate config file, please refer to:
        https://github.com/prometheus/snmp_exporter/tree/main/generator
    scrape_config_file:
      type: string
      default: ""
      description: >
        Custom Prometheus scrape config file (yaml).

        To send the contents of a file to this configuration option, the symbol `@` must be used.

        Usage: juju config snmp-exporter scrape_config_file=@scrape_config.yaml

        For reference on how to format the Prometheus config file, please refer to:
        https://github.com/prometheus/snmp_exporter?tab=readme-ov-file#prometheus-configuration
